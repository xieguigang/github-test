<html>
  <head>
    <title>ApplicationServices\Parallel\Threads\Groups\GroupAPI.vb</title>
    <style type="text/css">
                            
            .vscode {
                background-color: white;
                font: normal 11px Consolas, Microsoft YaHei;   
                color: black;
            }
            .keyword {
                color: #0000ff !important;
            }
            .comment {
                color: #008000 !important;
            }
            .type {
                color: #2b91af !important;
            }
            .string {
                color: #a31515 !important;
            }   
            .xml_comment {
                color: #808080 !important;
            }
            .xml {
                color: gray !important;
            }
            .xml_interpolate {
                color: cyan !important;
            }
        
                        </style>
    <style type="text/css">                           
                            .js-line-number {
                                color: #2b91af;                                
                                text-align: right;
                                padding-right: 5px;
                                border-right-style: inset;
                            }

                            .js-file-line .js-line-number {
                                font: normal 11px Consolas, Microsoft YaHei;
                            }

                            .js-file-line {
                                padding-left: 10px;
                            }
                        </style>
  </head>
  <body>
    <div class="vscode">
                            <table class="highlight tab-size js-file-line-container" data-tab-size="8">
  <tbody><tr>
  <td id="L1" class="blob-num js-line-number" data-line-number="1">1</td>
  <td id="LC1" class="blob-code blob-code-inner js-file-line">#Region&nbsp;<span class="string">"Microsoft.VisualBasic::91c0c7bf05f5cc78570c51304351cd2d,&nbsp;Microsoft.VisualBasic.Core\ApplicationServices\Parallel\Threads\Groups\GroupAPI.vb"</span><br /></td>
</tr>
<tr>
  <td id="L2" class="blob-num js-line-number" data-line-number="2">2</td>
  <td id="LC2" class="blob-code blob-code-inner js-file-line"><br /></td>
</tr>
<tr>
  <td id="L3" class="blob-num js-line-number" data-line-number="3">3</td>
  <td id="LC3" class="blob-code blob-code-inner js-file-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">'&nbsp;Author:</span><br /></td>
</tr>
<tr>
  <td id="L4" class="blob-num js-line-number" data-line-number="4">4</td>
  <td id="LC4" class="blob-code blob-code-inner js-file-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">'&nbsp;</span><br /></td>
</tr>
<tr>
  <td id="L5" class="blob-num js-line-number" data-line-number="5">5</td>
  <td id="LC5" class="blob-code blob-code-inner js-file-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;asuka&nbsp;(amethyst.asuka@gcmodeller.org)</span><br /></td>
</tr>
<tr>
  <td id="L6" class="blob-num js-line-number" data-line-number="6">6</td>
  <td id="LC6" class="blob-code blob-code-inner js-file-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xie&nbsp;(genetics@smrucc.org)</span><br /></td>
</tr>
<tr>
  <td id="L7" class="blob-num js-line-number" data-line-number="7">7</td>
  <td id="LC7" class="blob-code blob-code-inner js-file-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xieguigang&nbsp;(xie.guigang@live.com)</span><br /></td>
</tr>
<tr>
  <td id="L8" class="blob-num js-line-number" data-line-number="8">8</td>
  <td id="LC8" class="blob-code blob-code-inner js-file-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">'&nbsp;</span><br /></td>
</tr>
<tr>
  <td id="L9" class="blob-num js-line-number" data-line-number="9">9</td>
  <td id="LC9" class="blob-code blob-code-inner js-file-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">'&nbsp;Copyright&nbsp;(c)&nbsp;2018&nbsp;GPL3&nbsp;Licensed</span><br /></td>
</tr>
<tr>
  <td id="L10" class="blob-num js-line-number" data-line-number="10">10</td>
  <td id="LC10" class="blob-code blob-code-inner js-file-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">'&nbsp;</span><br /></td>
</tr>
<tr>
  <td id="L11" class="blob-num js-line-number" data-line-number="11">11</td>
  <td id="LC11" class="blob-code blob-code-inner js-file-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">'&nbsp;</span><br /></td>
</tr>
<tr>
  <td id="L12" class="blob-num js-line-number" data-line-number="12">12</td>
  <td id="LC12" class="blob-code blob-code-inner js-file-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">'&nbsp;GNU&nbsp;GENERAL&nbsp;PUBLIC&nbsp;LICENSE&nbsp;(GPL3)</span><br /></td>
</tr>
<tr>
  <td id="L13" class="blob-num js-line-number" data-line-number="13">13</td>
  <td id="LC13" class="blob-code blob-code-inner js-file-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">'&nbsp;</span><br /></td>
</tr>
<tr>
  <td id="L14" class="blob-num js-line-number" data-line-number="14">14</td>
  <td id="LC14" class="blob-code blob-code-inner js-file-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">'&nbsp;</span><br /></td>
</tr>
<tr>
  <td id="L15" class="blob-num js-line-number" data-line-number="15">15</td>
  <td id="LC15" class="blob-code blob-code-inner js-file-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">'&nbsp;This&nbsp;program&nbsp;is&nbsp;free&nbsp;software:&nbsp;you&nbsp;can&nbsp;redistribute&nbsp;it&nbsp;and/or&nbsp;modify</span><br /></td>
</tr>
<tr>
  <td id="L16" class="blob-num js-line-number" data-line-number="16">16</td>
  <td id="LC16" class="blob-code blob-code-inner js-file-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">'&nbsp;it&nbsp;under&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;GNU&nbsp;General&nbsp;<span class="keyword">Public</span>&nbsp;License&nbsp;as&nbsp;published&nbsp;by</span><br /></td>
</tr>
<tr>
  <td id="L17" class="blob-num js-line-number" data-line-number="17">17</td>
  <td id="LC17" class="blob-code blob-code-inner js-file-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">'&nbsp;the&nbsp;Free&nbsp;Software&nbsp;Foundation,&nbsp;either&nbsp;version&nbsp;3&nbsp;of&nbsp;the&nbsp;License,&nbsp;or</span><br /></td>
</tr>
<tr>
  <td id="L18" class="blob-num js-line-number" data-line-number="18">18</td>
  <td id="LC18" class="blob-code blob-code-inner js-file-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">'&nbsp;(at&nbsp;your&nbsp;option)&nbsp;any&nbsp;later&nbsp;version.</span><br /></td>
</tr>
<tr>
  <td id="L19" class="blob-num js-line-number" data-line-number="19">19</td>
  <td id="LC19" class="blob-code blob-code-inner js-file-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">'&nbsp;</span><br /></td>
</tr>
<tr>
  <td id="L20" class="blob-num js-line-number" data-line-number="20">20</td>
  <td id="LC20" class="blob-code blob-code-inner js-file-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">'&nbsp;This&nbsp;program&nbsp;is&nbsp;distributed&nbsp;in&nbsp;the&nbsp;hope&nbsp;that&nbsp;it&nbsp;will&nbsp;be&nbsp;useful,</span><br /></td>
</tr>
<tr>
  <td id="L21" class="blob-num js-line-number" data-line-number="21">21</td>
  <td id="LC21" class="blob-code blob-code-inner js-file-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">'&nbsp;but&nbsp;WITHOUT&nbsp;ANY&nbsp;WARRANTY;&nbsp;without&nbsp;even&nbsp;the&nbsp;implied&nbsp;warranty&nbsp;of</span><br /></td>
</tr>
<tr>
  <td id="L22" class="blob-num js-line-number" data-line-number="22">22</td>
  <td id="LC22" class="blob-code blob-code-inner js-file-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">'&nbsp;MERCHANTABILITY&nbsp;or&nbsp;FITNESS&nbsp;FOR&nbsp;A&nbsp;PARTICULAR&nbsp;PURPOSE.&nbsp;&nbsp;See&nbsp;the</span><br /></td>
</tr>
<tr>
  <td id="L23" class="blob-num js-line-number" data-line-number="23">23</td>
  <td id="LC23" class="blob-code blob-code-inner js-file-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">'&nbsp;GNU&nbsp;General&nbsp;<span class="keyword">Public</span>&nbsp;License&nbsp;for&nbsp;more&nbsp;details.</span><br /></td>
</tr>
<tr>
  <td id="L24" class="blob-num js-line-number" data-line-number="24">24</td>
  <td id="LC24" class="blob-code blob-code-inner js-file-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">'&nbsp;</span><br /></td>
</tr>
<tr>
  <td id="L25" class="blob-num js-line-number" data-line-number="25">25</td>
  <td id="LC25" class="blob-code blob-code-inner js-file-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">'&nbsp;You&nbsp;should&nbsp;have&nbsp;received&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;GNU&nbsp;General&nbsp;<span class="keyword">Public</span>&nbsp;License</span><br /></td>
</tr>
<tr>
  <td id="L26" class="blob-num js-line-number" data-line-number="26">26</td>
  <td id="LC26" class="blob-code blob-code-inner js-file-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">'&nbsp;along&nbsp;with&nbsp;this&nbsp;program.&nbsp;<span class="keyword">If</span>&nbsp;not,&nbsp;see&nbsp;&lt;http://www.gnu.org/licenses/&gt;.</span><br /></td>
</tr>
<tr>
  <td id="L27" class="blob-num js-line-number" data-line-number="27">27</td>
  <td id="LC27" class="blob-code blob-code-inner js-file-line"><br /></td>
</tr>
<tr>
  <td id="L28" class="blob-num js-line-number" data-line-number="28">28</td>
  <td id="LC28" class="blob-code blob-code-inner js-file-line"><br /></td>
</tr>
<tr>
  <td id="L29" class="blob-num js-line-number" data-line-number="29">29</td>
  <td id="LC29" class="blob-code blob-code-inner js-file-line"><br /></td>
</tr>
<tr>
  <td id="L30" class="blob-num js-line-number" data-line-number="30">30</td>
  <td id="LC30" class="blob-code blob-code-inner js-file-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">'&nbsp;/********************************************************************************/</span><br /></td>
</tr>
<tr>
  <td id="L31" class="blob-num js-line-number" data-line-number="31">31</td>
  <td id="LC31" class="blob-code blob-code-inner js-file-line"><br /></td>
</tr>
<tr>
  <td id="L32" class="blob-num js-line-number" data-line-number="32">32</td>
  <td id="LC32" class="blob-code blob-code-inner js-file-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">'&nbsp;Summaries:</span><br /></td>
</tr>
<tr>
  <td id="L33" class="blob-num js-line-number" data-line-number="33">33</td>
  <td id="LC33" class="blob-code blob-code-inner js-file-line"><br /></td>
</tr>
<tr>
  <td id="L34" class="blob-num js-line-number" data-line-number="34">34</td>
  <td id="LC34" class="blob-code blob-code-inner js-file-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">Module</span>&nbsp;GroupAPI</span><br /></td>
</tr>
<tr>
  <td id="L35" class="blob-num js-line-number" data-line-number="35">35</td>
  <td id="LC35" class="blob-code blob-code-inner js-file-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">'&nbsp;</span><br /></td>
</tr>
<tr>
  <td id="L36" class="blob-num js-line-number" data-line-number="36">36</td>
  <td id="LC36" class="blob-code blob-code-inner js-file-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">'&nbsp;</span><br /></td>
</tr>
<tr>
  <td id="L37" class="blob-num js-line-number" data-line-number="37">37</td>
  <td id="LC37" class="blob-code blob-code-inner js-file-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">'&nbsp;</span><br /></td>
</tr>
<tr>
  <td id="L38" class="blob-num js-line-number" data-line-number="38">38</td>
  <td id="LC38" class="blob-code blob-code-inner js-file-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">'&nbsp;</span><br /></td>
</tr>
<tr>
  <td id="L39" class="blob-num js-line-number" data-line-number="39">39</td>
  <td id="LC39" class="blob-code blob-code-inner js-file-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">'&nbsp;/********************************************************************************/</span><br /></td>
</tr>
<tr>
  <td id="L40" class="blob-num js-line-number" data-line-number="40">40</td>
  <td id="LC40" class="blob-code blob-code-inner js-file-line"><br /></td>
</tr>
<tr>
  <td id="L41" class="blob-num js-line-number" data-line-number="41">41</td>
  <td id="LC41" class="blob-code blob-code-inner js-file-line">#<span class="keyword">End</span>&nbsp;Region<br /></td>
</tr>
<tr>
  <td id="L42" class="blob-num js-line-number" data-line-number="42">42</td>
  <td id="LC42" class="blob-code blob-code-inner js-file-line"><br /></td>
</tr>
<tr>
  <td id="L43" class="blob-num js-line-number" data-line-number="43">43</td>
  <td id="LC43" class="blob-code blob-code-inner js-file-line"><span class="keyword">Imports</span>&nbsp;System.Runtime.CompilerServices<br /></td>
</tr>
<tr>
  <td id="L44" class="blob-num js-line-number" data-line-number="44">44</td>
  <td id="LC44" class="blob-code blob-code-inner js-file-line"><br /></td>
</tr>
<tr>
  <td id="L45" class="blob-num js-line-number" data-line-number="45">45</td>
  <td id="LC45" class="blob-code blob-code-inner js-file-line"><span class="keyword">Namespace</span>&nbsp;Parallel<br /></td>
</tr>
<tr>
  <td id="L46" class="blob-num js-line-number" data-line-number="46">46</td>
  <td id="LC46" class="blob-code blob-code-inner js-file-line"><br /></td>
</tr>
<tr>
  <td id="L47" class="blob-num js-line-number" data-line-number="47">47</td>
  <td id="LC47" class="blob-code blob-code-inner js-file-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">Public</span>&nbsp;<span class="keyword">Module</span>&nbsp;GroupAPI<br /></td>
</tr>
<tr>
  <td id="L48" class="blob-num js-line-number" data-line-number="48">48</td>
  <td id="LC48" class="blob-code blob-code-inner js-file-line"><br /></td>
</tr>
<tr>
  <td id="L49" class="blob-num js-line-number" data-line-number="49">49</td>
  <td id="LC49" class="blob-code blob-code-inner js-file-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="xml_comment">'''&nbsp;&lt;summary&gt;</span><br /></td>
</tr>
<tr>
  <td id="L50" class="blob-num js-line-number" data-line-number="50">50</td>
  <td id="LC50" class="blob-code blob-code-inner js-file-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="xml_comment">'''&nbsp;貌似使用LINQ进行Group操作的时候是没有并行化的，灰非常慢，则可以使用这个拓展函数来获取较好的性能</span><br /></td>
</tr>
<tr>
  <td id="L51" class="blob-num js-line-number" data-line-number="51">51</td>
  <td id="LC51" class="blob-code blob-code-inner js-file-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="xml_comment">'''&nbsp;&lt;/summary&gt;</span><br /></td>
</tr>
<tr>
  <td id="L52" class="blob-num js-line-number" data-line-number="52">52</td>
  <td id="LC52" class="blob-code blob-code-inner js-file-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="xml_comment">'''&nbsp;&lt;typeparam&nbsp;name="T"&gt;&lt;/typeparam&gt;</span><br /></td>
</tr>
<tr>
  <td id="L53" class="blob-num js-line-number" data-line-number="53">53</td>
  <td id="LC53" class="blob-code blob-code-inner js-file-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="xml_comment">'''&nbsp;&lt;typeparam&nbsp;name="T_TAG"&gt;&lt;/typeparam&gt;</span><br /></td>
</tr>
<tr>
  <td id="L54" class="blob-num js-line-number" data-line-number="54">54</td>
  <td id="LC54" class="blob-code blob-code-inner js-file-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="xml_comment">'''&nbsp;&lt;param&nbsp;name="source"&gt;&lt;/param&gt;</span><br /></td>
</tr>
<tr>
  <td id="L55" class="blob-num js-line-number" data-line-number="55">55</td>
  <td id="LC55" class="blob-code blob-code-inner js-file-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="xml_comment">'''&nbsp;&lt;returns&gt;&lt;/returns&gt;</span><br /></td>
</tr>
<tr>
  <td id="L56" class="blob-num js-line-number" data-line-number="56">56</td>
  <td id="LC56" class="blob-code blob-code-inner js-file-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;Extension&gt;&nbsp;<span class="keyword">Public</span>&nbsp;<span class="keyword">Function</span>&nbsp;ParallelGroup(Of&nbsp;T,&nbsp;T_TAG)(source&nbsp;<span class="keyword">As</span>&nbsp;IEnumerable(Of&nbsp;T),&nbsp;__getGuid&nbsp;<span class="keyword">As</span>&nbsp;Func(Of&nbsp;T,&nbsp;T_TAG))&nbsp;<span class="keyword">As</span>&nbsp;GroupResult(Of&nbsp;T,&nbsp;T_TAG)()<br /></td>
</tr>
<tr>
  <td id="L57" class="blob-num js-line-number" data-line-number="57">57</td>
  <td id="LC57" class="blob-code blob-code-inner js-file-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">Call</span>&nbsp;$<span class="string">"Generating&nbsp;guid&nbsp;index..."</span>.__DEBUG_ECHO<br /></td>
</tr>
<tr>
  <td id="L58" class="blob-num js-line-number" data-line-number="58">58</td>
  <td id="LC58" class="blob-code blob-code-inner js-file-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">Dim</span>&nbsp;TAGS&nbsp;=&nbsp;(From&nbsp;x&nbsp;<span class="keyword">As</span>&nbsp;T&nbsp;<span class="keyword">In</span>&nbsp;source.AsParallel&nbsp;<span class="keyword">Select</span>&nbsp;guid&nbsp;=&nbsp;__getGuid(x),&nbsp;x).ToArray<br /></td>
</tr>
<tr>
  <td id="L59" class="blob-num js-line-number" data-line-number="59">59</td>
  <td id="LC59" class="blob-code blob-code-inner js-file-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">Call</span>&nbsp;Console.WriteLine($<span class="string">"[DEBUG&nbsp;{Now.ToString}]&nbsp;Start&nbsp;to&nbsp;create&nbsp;lquery&nbsp;partitions..."</span>)<br /></td>
</tr>
<tr>
  <td id="L60" class="blob-num js-line-number" data-line-number="60">60</td>
  <td id="LC60" class="blob-code blob-code-inner js-file-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">Dim</span>&nbsp;Partitions&nbsp;=&nbsp;TAGS.Split(TAGS.Length&nbsp;/&nbsp;Environment.ProcessorCount)<br /></td>
</tr>
<tr>
  <td id="L61" class="blob-num js-line-number" data-line-number="61">61</td>
  <td id="LC61" class="blob-code blob-code-inner js-file-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">Call</span>&nbsp;Console.WriteLine($<span class="string">"[DEBUG&nbsp;{Now.ToString}]&nbsp;<span class="keyword">In</span>voke&nbsp;parallel&nbsp;group&nbsp;operations...."</span>)<br /></td>
</tr>
<tr>
  <td id="L62" class="blob-num js-line-number" data-line-number="62">62</td>
  <td id="LC62" class="blob-code blob-code-inner js-file-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">Call</span>&nbsp;Console.WriteLine($<span class="string">"[DEBUG&nbsp;{Now.ToString}]&nbsp;First&nbsp;groups..."</span>)<br /></td>
</tr>
<tr>
  <td id="L63" class="blob-num js-line-number" data-line-number="63">63</td>
  <td id="LC63" class="blob-code blob-code-inner js-file-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">Dim</span>&nbsp;FirstGroups&nbsp;=&nbsp;(From&nbsp;Partition&nbsp;<span class="keyword">In</span>&nbsp;Partitions.AsParallel<br /></td>
</tr>
<tr>
  <td id="L64" class="blob-num js-line-number" data-line-number="64">64</td>
  <td id="LC64" class="blob-code blob-code-inner js-file-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">Select</span>&nbsp;(From&nbsp;obj&nbsp;<span class="keyword">In</span>&nbsp;(From&nbsp;<span class="keyword">To</span>ken&nbsp;<span class="keyword">In</span>&nbsp;Partition<br /></td>
</tr>
<tr>
  <td id="L65" class="blob-num js-line-number" data-line-number="65">65</td>
  <td id="LC65" class="blob-code blob-code-inner js-file-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">Select</span>&nbsp;<span class="keyword">To</span>ken.guid<br /></td>
</tr>
<tr>
  <td id="L66" class="blob-num js-line-number" data-line-number="66">66</td>
  <td id="LC66" class="blob-code blob-code-inner js-file-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Group&nbsp;guid&nbsp;By&nbsp;guid&nbsp;<span class="keyword">In</span>to&nbsp;Group).ToArray&nbsp;<span class="keyword">Select</span>&nbsp;obj.guid).ToArray).ToArray.Unlist<br /></td>
</tr>
<tr>
  <td id="L67" class="blob-num js-line-number" data-line-number="67">67</td>
  <td id="LC67" class="blob-code blob-code-inner js-file-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">Call</span>&nbsp;Console.WriteLine($<span class="string">"[DEBUG&nbsp;{Now.ToString}]&nbsp;Unique&nbsp;group..."</span>)<br /></td>
</tr>
<tr>
  <td id="L68" class="blob-num js-line-number" data-line-number="68">68</td>
  <td id="LC68" class="blob-code blob-code-inner js-file-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">Dim</span>&nbsp;UniqueGroup&nbsp;=&nbsp;(From&nbsp;TAG&nbsp;<span class="keyword">As</span>&nbsp;T_TAG<br /></td>
</tr>
<tr>
  <td id="L69" class="blob-num js-line-number" data-line-number="69">69</td>
  <td id="LC69" class="blob-code blob-code-inner js-file-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">In</span>&nbsp;FirstGroups.AsParallel<br /></td>
</tr>
<tr>
  <td id="L70" class="blob-num js-line-number" data-line-number="70">70</td>
  <td id="LC70" class="blob-code blob-code-inner js-file-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">Select</span>&nbsp;TAG<br /></td>
</tr>
<tr>
  <td id="L71" class="blob-num js-line-number" data-line-number="71">71</td>
  <td id="LC71" class="blob-code blob-code-inner js-file-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Group&nbsp;TAG&nbsp;By&nbsp;TAG&nbsp;<span class="keyword">In</span>to&nbsp;Group).ToArray<br /></td>
</tr>
<tr>
  <td id="L72" class="blob-num js-line-number" data-line-number="72">72</td>
  <td id="LC72" class="blob-code blob-code-inner js-file-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">Call</span>&nbsp;Console.WriteLine($<span class="string">"[DEBUG&nbsp;{Now.ToString}]&nbsp;Generating&nbsp;group&nbsp;result...."</span>)<br /></td>
</tr>
<tr>
  <td id="L73" class="blob-num js-line-number" data-line-number="73">73</td>
  <td id="LC73" class="blob-code blob-code-inner js-file-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">Call</span>&nbsp;Console.WriteLine(<span class="string">"&nbsp;*&nbsp;Cache&nbsp;data...."</span>)<br /></td>
</tr>
<tr>
  <td id="L74" class="blob-num js-line-number" data-line-number="74">74</td>
  <td id="LC74" class="blob-code blob-code-inner js-file-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">Dim</span>&nbsp;Cache&nbsp;=&nbsp;(From&nbsp;TAG&nbsp;<span class="keyword">In</span>&nbsp;UniqueGroup.AsParallel&nbsp;<span class="keyword">Select</span>&nbsp;TAG,&nbsp;List&nbsp;=&nbsp;<span class="keyword">New</span>&nbsp;List(Of&nbsp;T)).ToArray<br /></td>
</tr>
<tr>
  <td id="L75" class="blob-num js-line-number" data-line-number="75">75</td>
  <td id="LC75" class="blob-code blob-code-inner js-file-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">Call</span>&nbsp;Console.WriteLine(<span class="string">"&nbsp;*&nbsp;Address&nbsp;data....."</span>)<br /></td>
</tr>
<tr>
  <td id="L76" class="blob-num js-line-number" data-line-number="76">76</td>
  <td id="LC76" class="blob-code blob-code-inner js-file-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">Dim</span>&nbsp;Addressing&nbsp;=&nbsp;(From&nbsp;obj&nbsp;<span class="keyword">In</span>&nbsp;TAGS.AsParallel&nbsp;<span class="keyword">Select</span>&nbsp;obj,&nbsp;List&nbsp;=&nbsp;(From&nbsp;item&nbsp;<span class="keyword">In</span>&nbsp;Cache&nbsp;Where&nbsp;item.TAG.TAG.Equals(obj.guid)&nbsp;<span class="keyword">Select</span>&nbsp;item.List).FirstOrDefault).ToArray<br /></td>
</tr>
<tr>
  <td id="L77" class="blob-num js-line-number" data-line-number="77">77</td>
  <td id="LC77" class="blob-code blob-code-inner js-file-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">For</span>&nbsp;<span class="keyword">Each</span>&nbsp;Address&nbsp;<span class="keyword">In</span>&nbsp;Addressing<br /></td>
</tr>
<tr>
  <td id="L78" class="blob-num js-line-number" data-line-number="78">78</td>
  <td id="LC78" class="blob-code blob-code-inner js-file-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">Call</span>&nbsp;Address.List.Add(Address.obj.x)<br /></td>
</tr>
<tr>
  <td id="L79" class="blob-num js-line-number" data-line-number="79">79</td>
  <td id="LC79" class="blob-code blob-code-inner js-file-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">Next</span><br /></td>
</tr>
<tr>
  <td id="L80" class="blob-num js-line-number" data-line-number="80">80</td>
  <td id="LC80" class="blob-code blob-code-inner js-file-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">Call</span>&nbsp;Console.WriteLine(<span class="string">"&nbsp;*&nbsp;Generate&nbsp;result....."</span>)<br /></td>
</tr>
<tr>
  <td id="L81" class="blob-num js-line-number" data-line-number="81">81</td>
  <td id="LC81" class="blob-code blob-code-inner js-file-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">Dim</span>&nbsp;LQuery&nbsp;=&nbsp;(From&nbsp;TAG&nbsp;<span class="keyword">In</span>&nbsp;Cache.AsParallel&nbsp;<span class="keyword">Select</span>&nbsp;<span class="keyword">New</span>&nbsp;GroupResult(Of&nbsp;T,&nbsp;T_TAG)()&nbsp;<span class="keyword">With</span>&nbsp;{.Tag&nbsp;=&nbsp;TAG.TAG.TAG,&nbsp;.Group&nbsp;=&nbsp;TAG.List.ToArray}).ToArray<br /></td>
</tr>
<tr>
  <td id="L82" class="blob-num js-line-number" data-line-number="82">82</td>
  <td id="LC82" class="blob-code blob-code-inner js-file-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">Call</span>&nbsp;Console.WriteLine($<span class="string">"[DEBUG&nbsp;{Now.ToString}]&nbsp;Parallel&nbsp;group&nbsp;operation&nbsp;job&nbsp;done!"</span>)<br /></td>
</tr>
<tr>
  <td id="L83" class="blob-num js-line-number" data-line-number="83">83</td>
  <td id="LC83" class="blob-code blob-code-inner js-file-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">Return</span>&nbsp;LQuery<br /></td>
</tr>
<tr>
  <td id="L84" class="blob-num js-line-number" data-line-number="84">84</td>
  <td id="LC84" class="blob-code blob-code-inner js-file-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">End</span>&nbsp;<span class="keyword">Function</span><br /></td>
</tr>
<tr>
  <td id="L85" class="blob-num js-line-number" data-line-number="85">85</td>
  <td id="LC85" class="blob-code blob-code-inner js-file-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">End</span>&nbsp;<span class="keyword">Module</span><br /></td>
</tr>
<tr>
  <td id="L86" class="blob-num js-line-number" data-line-number="86">86</td>
  <td id="LC86" class="blob-code blob-code-inner js-file-line"><span class="keyword">End</span>&nbsp;<span class="keyword">Namespace</span><br /></td>
</tr></tbody>
</table>
                        </div>
  </body>
</html>